<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Article">
<head>
    <title>파이썬 함수형 언어 파트 3 :: [Young Gyu&#39;s blog]</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, ya-title=fade, ya-dock=fade">

    <!--favicons-->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png?v=NmYO8WoKWA">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png?v=NmYO8WoKWA">

    <link rel="icon" type="image/png" href="/favicon-32x32.png?v=NmYO8WoKWA" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png?v=NmYO8WoKWA" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png?v=NmYO8WoKWA" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png?v=NmYO8WoKWA" sizes="16x16">

    <link rel="manifest" href="/manifest.json?v=NmYO8WoKWA">

    <meta name="msapplication-TileColor" content="#474747">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png?v=NmYO8WoKWA">
    <meta name="theme-color" content="#474747">

    <link rel="yandex-tableau-widget" href="/yandex-widget-manifest.json" />
    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" href="/css/style.css" />
    <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
    <link rel="alternate" type="application/rss+xml" title="Лента" href="/feed.rss" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

    <meta name="title" content="파이썬 함수형 언어 파트 3 :: [Young Gyu&#39;s blog]" />
    <meta name="description" content="Expression bindings결코 부분적 해결책들에 만족하지 마라 - Never content with partial solutions, one reader – Richard Davies – raised the issue of whether we might move bindings all the way into individual expressions. Let’s take a quick look at why we might want to do that, and also show a remarkably elegant means of expression provided by a comp.lang.python contributor.먼저 functional module의 Bindings 클래스를 다시 생각해 보겠습니다. 그 클래스의 속성들을 사용하여, Let’s first recall the Bindings class of the functional module. Using the attributes..." />
    <meta name="keywords" content="numpy, python" />
    <meta name="author" content="Young Gyu Park"/>

    <meta itemprop="name" content="파이썬 함수형 언어 파트 3 :: [Young Gyu&#39;s blog]"/>
    <meta itemprop="description" content="Expression bindings결코 부분적 해결책들에 만족하지 마라 - Never content with partial solutions, one reader – Richard Davies – raised the issue of whether we might move bindings all the way into individual expressions. Let’s take a quick look at why we might want to do that, and also show a remarkably elegant means of expression provided by a comp.lang.python contributor.먼저 functional module의 Bindings 클래스를 다시 생각해 보겠습니다. 그 클래스의 속성들을 사용하여, Let’s first recall the Bindings class of the functional module. Using the attributes..."/>

    <meta property="fb:admins" content="1201794820" />
    <meta property="og:site_name" content="[young gyu's blog]" />
    <meta property="og:title" content="파이썬 함수형 언어 파트 3 :: [Young Gyu&#39;s blog]" />
    <meta property="og:url" content="http://ygpark2.github.io//posts/2014/02/10/Functional_Programming_in_Python_part3.html/" />
    <meta property="og:description" content="Expression bindings결코 부분적 해결책들에 만족하지 마라 - Never content with partial solutions, one reader – Richard Davies – raised the issue of whether we might move bindings all the way into individual expressions. Let’s take a quick look at why we might want to do that, and also show a remarkably elegant means of expression provided by a comp.lang.python contributor.먼저 functional module의 Bindings 클래스를 다시 생각해 보겠습니다. 그 클래스의 속성들을 사용하여, Let’s first recall the Bindings class of the functional module. Using the attributes..." />
    <meta property="og:locale" content="ko_KR" />
    <meta property="fb:profile_id" content="1201794820" />

    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" />

    
    
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2014-02-10T02:00:00Z" />
    <meta property="article:author" content="1201794820" />
    <meta property="article:publisher" content="1201794820" />
    <meta property="article:tag" content="numpy" />
    <meta property="article:tag" content="python" />
    
    
    

    <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-32213724-1']);
    _gaq.push(['_setDomainName', 'ygpark2']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>

</head>

<body>
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle navbar-toggle-button">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">[Young Gyu's blog]</a>
        </div>

        <div class="collapse navbar-collapse navbar-collapsible-block">
            <ul class="nav navbar-nav navbar-left">
                <li ><a href="/projects/">Projects</a></li>
                <li ><a href='/archive/'>Archive</a></li>
                <li ><a href='/about/'>About</a></li>
            </ul>

            <div class="nav navbar-nav navbar-right navbar-form hidden-xs hidden-sm">
                <a class="btn btn-rss navbar-btn" href="/feed.rss" title="RSS">
                  <i class="fa fa-rss fa-2x"></i>
                </a>
                <a class="btn btn-github navbar-btn" href="https://github.com/ygpark2/ygpark2.github.io" title="The source code for the site GitHub">
                  <i class="fa fa-github-circled fa-2x"></i>
                </a>
            </div>
        </div>
    </div>
</nav>


<div class="container">
    <div class="panel-group">
        <div class="panel panel-default post-container">
    <div class="panel-body post-body">
        <h1>파이썬 함수형 언어 파트 3</h1>

        <h2 id='p-1'>Expression bindings</h2><p id='p-2'>결코 부분적 해결책들에 만족하지 마라 - Never content with partial solutions, one reader – Richard Davies – raised the issue of whether we might move bindings all the way into individual expressions. Let’s take a quick look at why we might want to do that, and also show a remarkably elegant means of expression provided by a comp.lang.python contributor.</p><p id='p-3'>먼저 functional module의 Bindings 클래스를 다시 생각해 보겠습니다. 그 클래스의 속성들을 사용하여, Let’s first recall the Bindings class of the functional module. Using the attributes of that class, we were able to assure that a particular name means only one thing within a given block scope:</p><p id='p-4'>Listing 1: Python FP session with guarded rebinding</p><pre class='sourceCode python'><code class='sourceCode python'>&gt;&gt;&gt; from functional import *
&gt;&gt;&gt; let = Bindings()
&gt;&gt;&gt; let.car = lambda lst: lst[0]
&gt;&gt;&gt; let.car = lambda lst: lst[2]
Traceback (innermost last):
  File "&lt;stdin&gt;", line 1, in ?
  File "d:\tools\functional.py", line 976, in __setattr__

raise BindingError, "Binding '%s' cannot be modified." % name
functional.BindingError:  Binding 'car' cannot be modified.
&gt;&gt;&gt; let.car(range(10))
0</code></pre><p id='p-5'>The Bindings class does what we want within a module or function def scope, but there is no way to make it work within a single expression. In ML-family languages, however, it is natural to create bindings within a single expression: Listing 2: Haskell expression-level name bindings <sub>~</sub>~~haskell – car (x:xs) = x – <em>could</em> create module-level binding list_of_list = [[1,2,3],[4,5,6],[7,8,9]]</p><p id='p-6'>– 'where' clause for expression-level binding firsts1 = [car x | x &lt;- list_of_list] where car (x:xs) = x</p><p id='p-7'>– 'let' clause for expression-level binding firsts2 = let car (x:xs) = x in [car x | x &lt;- list_of_list]</p><p id='p-8'>– more idiomatic higher-order 'map' technique firsts3 = map car list_of_list where car (x:xs) = x</p><p id='p-9'>– Result: firsts1 == firsts2 == firsts3 == [1,4,7] <sub>~</sub>~~</p><p id='p-10'>Greg Ewing observed that it is possible to accomplish the same effect using Python’s list comprehensions; we can even do it in a way that is nearly as clean as Haskell’s syntax: Listing 3: Python 2.0+ expression-level name bindings <sub><sub><sub><s>python &gt;&gt;&gt; list_of_list = [[1,2,3],[4,5,6],[7,8,9]] &gt;&gt;&gt; [car_x for x in list_of_list for car_x in (x[0],)][1, 4, 7] This trick of putting an expression inside a single-item tuple in a list comprehension does not provide any way of using expression-level bindings with higher-order functions. To use the higher-order functions, we still need to use block-level bindings, as with: Listing 4: Python block-level bindings with 'map()' &gt;&gt;&gt; list_of_list = [[1,2,3],[4,5,6],[7,8,9]] &gt;&gt;&gt; let = Bindings() &gt;&gt;&gt; let.car = lambda l: l[0] &gt;&gt;&gt; map(let.car,list_of_list) [1, 4, 7]</s></sub></sub></sub></p><p id='p-11'>Not bad, but if we want to use map(), the scope of the binding remains a little broader than we might want. Nonetheless, it is possible to coax list comprehensions into doing our name bindings for us, even in cases where a list is not what we finally want: Listing 5: «Stepping down» from Python list comprehension <sub><sub><sub><s>haskell Compare Haskell expression: result = func car_car where car (x:xs) = x car_car = car (car list_of_list) func x = x + x^2</s></sub></sub></sub></p><pre class='sourceCode python'><code class='sourceCode python'>&gt;&gt;&gt; [func for x in list_of_list
...
for car in (x[0],)
...
for func in (car+car**2,)][0]
2</code></pre><p id='p-12'>We have performed an arithmetic calculation on the first element of the first element of list_of_list while also naming the arithmetic calculation (but only in expression scope). As an «optimization» we might not bother to create a list longer than one element to start with, since we choose only the first element with the ending index 0: Listing 6: Efficient stepping down from list comprehension <sub><sub><sub><s>python &gt;&gt;&gt; [func for x in list_of_list[:1] … for car in (x[0],) … for func in (car+car**2,)][0] 2</s></sub></sub></sub></p><h2 id='p-13'>Higher-order functions: currying</h2><p id='p-14'>Three of the most general higher-order functions are built into Python: map(), reduce(), and filter(). What these functions do – and the reason we call them «higher-order» – is take other functions as (some of) their arguments. Other higher-order functions, but not these built-ins, return function objects. Python has always given users the ability to construct their own higher-order functions by virtue of the first-class status of function objects. A trivial case might look like this: Listing 7: Trivial Python function factory <sub><sub><sub><s>python &gt;&gt;&gt; def foo_factory(): … def foo(): … print «Foo function from factory» … return foo … &gt;&gt;&gt; f = foo_factory() &gt;&gt;&gt; f()</s></sub></sub></sub></p><h2 id='p-15'>Foo function from factory</h2><p id='p-16'>The Xoltar Toolkit, which I discussed in Part 2 of this series, comes with a nice collection of higher-order functions. Most of the functions that Xoltar’s functional module provides are ones developed in various traditionally functional languages, and whose usefulness have been proven over many years. Possibly the most famous and most important higher-order function is curry(). curry() is named after the logician Haskell Curry, whose first name is also used to name the above-mentioned programming language. The underlying insight of «currying» is that it is possible to treat (almost) every function as a partial function of just one argument. All that is necessary for currying to work is to allow the return value of functions to themselves be functions, but with the returned functions «narrowed» or «closer to completion.» This works quite similarly to the closures I wrote about in Part 2 – each successive call to a curried return function «fills in» more of the data involved in a final computation (data attached to a procedure). Let’s illustrate currying first with a very simple example in Haskell, then with the same example repeated in Python using the functional module: Listing 8: Currying a Haskell computation computation a b c d = (a + b^2+ c^3 + d^4) check = 1 + 2^2 + 3^3 + 5^4</p><pre class='sourceCode haskell'><code class='sourceCode haskell'>fillOne   = computation 1
-- specify "a"
fillTwo   = fillOne 2
-- specify "b"
fillThree = fillTwo 3
-- specify "c"
answer    = fillThree 5
-- specify "d"
-- Result: check == answer == 657</code></pre><p id='p-17'>Now in Python: Listing 9: Currying a Python computation <sub>~</sub>~~python &gt;&gt;&gt; from functional import curry &gt;&gt;&gt; computation = lambda a,b,c,d: (a + b<strong>2 + c</strong>3 + d**4) &gt;&gt;&gt; computation(1,2,3,5) 657 &gt;&gt;&gt; fillZero = curry(computation) &gt;&gt;&gt; fillOne = fillZero(1) # specify «a» &gt;&gt;&gt; fillTwo = fillOne(2) # specify «b» &gt;&gt;&gt; fillThree = fillTwo(3) # specify «c» &gt;&gt;&gt; answer = fillThree(5) # specify «d» &gt;&gt;&gt; answer 657 <sub>~</sub>~~</p><p id='p-18'>It is possible to further illustrate the parallel with closures by presenting the same simple tax-calculation program used in Part 2 (this time using curry()): Listing 10: Python curried tax calculations</p><pre class='sourceCode python'><code class='sourceCode python'>from functional import *
taxcalc = lambda income,rate,deduct: (income-(deduct))*rate

taxCurry = curry(taxcalc)
taxCurry = taxCurry(50000)
taxCurry = taxCurry(0.30)
taxCurry = taxCurry(10000)
print "Curried taxes due =",taxCurry

print "Curried expression taxes due =", \
      curry(taxcalc)(50000)(0.30)(10000)</code></pre><p id='p-19'>Unlike with closures, we need to curry the arguments in a specific order (left to right). But note that functional also contains an rcurry() class that will start at the other end (right to left). The second print statement in the example at one level is a trivial spelling change from simply calling the normal taxcalc(50000,0.30,10000). In a different level, however, it makes rather clear the concept that every function can be a function of just one argument – a rather surprising idea to those new to it.</p><h2 id='p-20'>Miscellaneous higher-order functions</h2><p id='p-21'>Beyond the «fundamental» operation of currying, functional provides a grab-bag of interesting higher-order functions. Moreover, it is really not hard to write your own higher-order functions – either with or without functional. The ones in functional provide some interesting ideas, at the least. For the most part, higher-order functions feel like «enhanced» versions of the standard map(), filter(), and reduce(). Often, the pattern in these functions is roughly «take a function or functions and some lists as arguments, then apply the function(s) to list arguments.» There are a surprising number of interesting and useful ways to play on this theme. Another pattern is «take a collection of functions and create a function that combines their functionality.» Again, numerous variations are possible. Let’s look at some of what functional provides. The functions sequential() and also() both create a function based on a sequence of component functions. The component functions can then be called with the same argument(s). The main difference between the two is simply that sequential() expects a single list as an argument, while also() takes a list of arguments. In most cases, these are useful for function side effects, but sequential() optionally lets you choose which function provides the combined return value: Listing 11: Sequential calls to functions (with same args)</p><pre class='sourceCode python'><code class='sourceCode python'>&gt;&gt;&gt; def a(x):
...     print x,
...     return "a"
...
&gt;&gt;&gt; def b(x):
...     print x*2,
...     return "b"
...
&gt;&gt;&gt; def c(x):
...     print x*3,
...     return "c"
...
&gt;&gt;&gt; r = also(a,b,c)
&gt;&gt;&gt; r
&lt;functional.sequential instance at 0xb86ac&gt;
&gt;&gt;&gt; r(5)
5 10 15
'a'
&gt;&gt;&gt; sequential([a,b,c],main=c)('x')
x xx xxx
'c'</code></pre><p id='p-22'>The functions disjoin() and conjoin() are similar to sequential() and also() in terms of creating new functions that apply argument(s) to several component functions. But disjoin() asks whether any component functions return true (given the argument(s)), and conjoin() asks whether all components return true. Logical shortcutting is applied, where possible, so some side effects might not occur with disjoin(). joinfuncs() is similar to also(), but returns a tuple of the components’ return values rather than selecting a main one. Where the previous functions let you call multiple functions with the same argument(s), any(), all(), and none_of() let you call the same function against a list of arguments. In general structure, these are a bit like the built-in map(), reduce(), filter() functions. But these particular higher-order functions from functional ask Boolean questions about collections of return values. For example: Listing 12: Ask about collections of return values <sub>~</sub>~~python &gt;&gt;&gt; from functional import * &gt;&gt;&gt; isEven = lambda n: (n%2 == 0) &gt;&gt;&gt; any([1,3,5,8], isEven) 1 &gt;&gt;&gt; any([1,3,5,7], isEven) 0 &gt;&gt;&gt; none_of([1,3,5,7], isEven) 1 &gt;&gt;&gt; all([2,4,6,8], isEven) 1 &gt;&gt;&gt; all([2,4,6,7], isEven) 0 <sub>~</sub>~~</p><p id='p-23'>A particularly interesting higher-order function for those with a little bit of mathematics background is compose(). The composition of several functions is a «chaining together» of the return value of one function to the input of the next function. The programmer who composes several functions is responsible for making sure the outputs and inputs match up – but then, that is true any time a programmer uses a return value. A simple example makes it clear: Listing 13: Creating compositional functions <sub>~</sub>~~python &gt;&gt;&gt; def minus7(n): return n-7 … &gt;&gt;&gt; def times3(n): return n*3 … &gt;&gt;&gt; minus7(10) 3 &gt;&gt;&gt; minustimes = compose(times3,minus7) &gt;&gt;&gt; minustimes(10) 9 &gt;&gt;&gt; times3(minus7(10)) 9 &gt;&gt;&gt; timesminus = compose(minus7,times3) &gt;&gt;&gt; timesminus(10) 23 &gt;&gt;&gt; minus7(times3(10)) 23 <sub>~</sub>~~</p>
    </div>

    <div class="panel-footer">
    
        <a href="/tag/numpy/" class="label label-default">numpy</a> <a href="/tag/python/" class="label label-default">python</a>  |
    

    <i class="fa fa-calendar"></i> <span data-post-date="2014-02-10T02:00:00+0000">Monday, 10 February 2014, 02:00</span>

    

    |
    <div class="fb-like" data-href="http://ygpark2.github.io/posts/2014/02/10/Functional_Programming_in_Python_part3.html/" data-layout="button_count" data-action="like"
         data-show-faces="true" data-share="false"
         style="display:inline-block;position:relative"></div>
    <div style="display:inline-block;vertical-align:middle;position:relative;top:2px;padding-left:14px">
        <div class="g-plusone" data-size="medium" data-href="http://ygpark2.github.io/posts/2014/02/10/Functional_Programming_in_Python_part3.html/"></div>
    </div>
    
</div>


<div id="fb-root"></div>
<script type="text/javascript">

window.fbAsyncInit = function() {
    FB.init({
        appId: '261906013973423',
        status: true,
        xfbml: true
    });
};
(function(d){
    var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    d.getElementsByTagName('head')[0].appendChild(js);
}(document));

window.___gcfg = {lang: 'en', parsetags: 'onload'};
(function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script>



    


    <div id="disqus_thread" class="panel-body">
        <ul class="media-list">
    
</ul>

    </div>

    <div class="disqus-post">
    <script type="text/javascript">
        var disqus_shortname='ygpark2',disqus_identifier='posts/2014/02/10/Functional_Programming_in_Python_part3.html.md',disqus_url='http://ygpark2.github.io/posts/2014/02/10/Functional_Programming_in_Python_part3.html/',disqus_title='파이썬 함수형 언어 파트 3';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

</div>


        <footer class="panel panel-default component-panel">
    <div class="panel-body post-body">
        &copy;
        <span itemprop='copyrightHolder' itemscope='itemscope' itemtype='http://schema.org/Person'>
    	     <span itemprop='name'>Young Gyu Park</span>
        </span>,
        <span itemprop='copyrightYear'>2013 — 2015</span>
        <br />
        My favorite concealer:
        <span itemprop='contributor' itemscope='itemscope' itemtype='http://schema.org/Person'>
    	     <span itemprop='name'>Sunju Lim</span>
        </span>
    </div>
</footer>

    </div>
</div>
<!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter18572794 = new Ya.Metrika({id:18572794}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/18572794" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->
<script type="text/javascript" src="/dart/s.js"></script>
<script type="text/javascript" src="/dart/script.dart.js"></script>

</body>
</html>


